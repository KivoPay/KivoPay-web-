<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KivoPay Store ‚Äî Aplikasi Premium</title>
  <style>
    :root{
      --bg:#070a12;
      --card: rgba(255,255,255,.08);
      --card2: rgba(255,255,255,.10);
      --b: rgba(255,255,255,.12);
      --t:#eaf0ff;
      --m:#aeb9d6;
      --a:#6ea8fe;
      --g:#7cffb2;
      --r:18px;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--t);
      background:
        radial-gradient(900px 520px at 10% 10%,rgba(110,168,254,.18),transparent 55%),
        radial-gradient(800px 520px at 90% 20%,rgba(124,255,178,.10),transparent 55%),
        radial-gradient(900px 520px at 60% 90%,rgba(180,120,255,.10),transparent 55%),
        var(--bg);
      min-height:100vh;
      overflow-x:hidden;
    }
    a{color:inherit}
    .wrap{max-width:1050px;margin:0 auto;padding:14px 14px 90px}
    header{
      position:sticky;top:0;z-index:10;
      background: rgba(7,10,18,.65);
      backdrop-filter: blur(10px);
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .topbar{display:flex;align-items:center;gap:12px;max-width:1050px;margin:0 auto;padding:12px 14px}
    .brand{display:flex;align-items:center;gap:10px;min-width:0}
    .logo{
      width:42px;height:42px;border-radius:14px;
      display:grid;place-items:center;
      background: linear-gradient(135deg, rgba(110,168,254,.95), rgba(124,255,178,.55));
      box-shadow: 0 10px 30px rgba(110,168,254,.18);
      font-weight:800;
    }
    .btxt{min-width:0}
    .btxt b{display:block;font-size:15px;letter-spacing:.2px}
    .btxt span{display:block;color:var(--m);font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .right{margin-left:auto;display:flex;align-items:center;gap:10px}
    .pill{
      display:flex;align-items:center;gap:8px;
      padding:8px 10px;border-radius:999px;
      background: rgba(255,255,255,.07);
      border:1px solid rgba(255,255,255,.10);
      color:var(--m);
      font-size:12px;
    }
    .dot{width:8px;height:8px;border-radius:50%;background:var(--g);box-shadow:0 0 18px rgba(124,255,178,.45)}
    .btn{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      color:var(--t);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      font-weight:650;
      transition: transform .12s ease, background .12s ease;
    }
    .btn:hover{transform: translateY(-1px);background: rgba(255,255,255,.10)}
    .btn.primary{
      border-color: rgba(110,168,254,.38);
      background: linear-gradient(135deg, rgba(110,168,254,.95), rgba(110,168,254,.35));
      box-shadow: 0 14px 40px rgba(110,168,254,.18);
    }
    .btn.ghost{background: transparent}
    .hero{
      margin-top:14px;
      padding:18px;
      border-radius:var(--r);
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    .hero::before,.hero::after{
      content:"";
      position:absolute;inset:auto;
      width:220px;height:220px;border-radius:50%;
      filter: blur(40px);
      opacity:.22;
      animation: floaty 7s ease-in-out infinite;
    }
    .hero::before{background: rgba(110,168,254,.9); left:-60px; top:-80px;}
    .hero::after{background: rgba(124,255,178,.9); right:-80px; bottom:-120px; animation-delay: -3s;}
    @keyframes floaty{0%,100%{transform: translate(0,0)}50%{transform: translate(22px,16px)}}
    .hero h1{margin:0 0 6px;font-size:18px}
    .typingLine{
      display:flex;align-items:center;gap:8px;
      color:var(--m);
      font-size:13px;
      min-height:20px;
    }
    .caret{
      width:10px;
      animation: blink 1s steps(2,end) infinite;
      color:rgba(255,255,255,.65);
    }
    @keyframes blink{50%{opacity:0}}
    .tools{
      margin-top:12px;
      display:flex;gap:10px;flex-wrap:wrap;
      align-items:center;
    }
    .search{
      flex:1;min-width:200px;
      display:flex;align-items:center;gap:10px;
      padding:10px 12px;border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
    }
    .search input{
      width:100%;
      background:transparent;border:0;outline:0;
      color:var(--t);
      font-size:14px;
    }
    .hint{color:var(--m);font-size:12px;margin-top:10px}
    .grid{
      margin-top:14px;
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:12px;
    }
    @media(min-width:860px){.grid{grid-template-columns: repeat(4, minmax(0,1fr));}}
    .card{
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      overflow:hidden;
      box-shadow: 0 14px 44px rgba(0,0,0,.25);
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .card:hover{transform: translateY(-2px);border-color: rgba(110,168,254,.25);background: rgba(255,255,255,.08);}
    .thumb{
      height:92px;
      background: rgba(255,255,255,.04);
      display:grid;place-items:center;
    }
    .thumb img{max-height:70px;max-width:90%;object-fit:contain;filter: drop-shadow(0 10px 20px rgba(0,0,0,.35));}
    .cbody{padding:10px 10px 12px}
    .cbody b{display:block;font-size:13px;line-height:1.2}
    .cbody span{display:block;color:var(--m);font-size:12px;margin-top:6px}
    .tag{
      display:inline-flex;align-items:center;gap:6px;
      padding:6px 10px;border-radius:999px;
      background: rgba(110,168,254,.10);
      border:1px solid rgba(110,168,254,.22);
      color: rgba(234,240,255,.9);
      font-size:12px;
      margin-top:10px;
    }

    /* modal */
    .overlay{
      position:fixed;inset:0;z-index:50;
      background: rgba(0,0,0,.55);
      display:none;
      padding:18px;
    }
    .overlay.show{display:block}
    .modal{
      max-width:560px;margin:0 auto;
      border-radius:22px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(15,18,28,.92);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
      overflow:hidden;
      transform: translateY(8px);
      animation: pop .14s ease forwards;
    }
    @keyframes pop{to{transform:translateY(0)}}
    .mhead{
      padding:14px 14px 10px;
      display:flex;align-items:center;gap:12px;
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    .mhead img{width:40px;height:40px;border-radius:14px;object-fit:cover;background:rgba(255,255,255,.06)}
    .mhead .tt{min-width:0}
    .mhead .tt b{display:block}
    .mhead .tt span{display:block;color:var(--m);font-size:12px}
    .mhead .x{margin-left:auto}
    .mbody{padding:14px}
    .variants{display:flex;flex-direction:column;gap:8px;margin-top:10px}
    .vbtn{
      text-align:left;
      padding:10px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      cursor:pointer;
      display:flex;justify-content:space-between;gap:10px;
    }
    .vbtn:hover{border-color: rgba(110,168,254,.22)}
    .vbtn.active{border-color: rgba(124,255,178,.38);background: rgba(124,255,178,.08)}
    .vbtn small{color:var(--m)}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .field{
      width:100%;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color:var(--t);
      outline:0;
    }
    .split{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media(max-width:520px){.split{grid-template-columns:1fr}}
    .paypick{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .pay{
      flex:1;min-width:140px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      padding:10px 12px;
      cursor:pointer;
      display:flex;align-items:center;gap:10px;
    }
    .pay img{width:34px;height:34px;border-radius:12px;background:rgba(255,255,255,.06);object-fit:contain}
    .pay b{display:block;font-size:13px}
    .pay span{display:block;color:var(--m);font-size:12px}
    .pay.active{border-color: rgba(110,168,254,.28);background: rgba(110,168,254,.09)}
    .paydetails{
      margin-top:10px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      padding:12px;
    }
    .qrisimg{
      width:100%;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      overflow:hidden;
      margin-top:10px;
    }
    .qrisimg img{width:100%;display:block}
    .mini{color:var(--m);font-size:12px;margin-top:10px;line-height:1.35}
    .toast{
      position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
      background: rgba(10,12,18,.86);
      border:1px solid rgba(255,255,255,.12);
      color:var(--t);
      padding:10px 12px;border-radius:14px;
      box-shadow: var(--shadow);
      display:none;
      z-index:90;
      font-size:13px;
    }
    .toast.show{display:block}
  </style>
</head>
<body>
<header>
  <div class="topbar">
    <div class="brand">
      <div class="logo">K</div>
      <div class="btxt">
        <b>KivoPay Store</b>
        <span>Aplikasi Premium ‚Ä¢ Order manual via WhatsApp Admin</span>
      </div>
    </div>
    <div class="right">
      <div class="pill"><span class="dot"></span> Ready</div>
      <button class="btn" id="btnLoginTop">Masuk</button>
    </div>
  </div>
</header>

<div class="wrap">
  <section class="hero">
    <h1>Aplikasi Premium (Lengkap)</h1>
    <div class="typingLine">
      <span id="typingText"></span><span class="caret">|</span>
    </div>

    <div class="tools">
      <div class="search">
        üîé <input id="q" placeholder="Cari produk... (contoh: Netflix, Canva, Remini)" autocomplete="off" />
      </div>
      <button class="btn ghost" id="btnReset">Reset</button>
    </div>

    <div class="hint">
      Cara order: <b>Klik produk</b> ‚Üí pilih paket ‚Üí (kalau belum masuk) isi <b>Nama & WhatsApp</b> ‚Üí pilih pembayaran ‚Üí <b>Order ke Admin</b>.
    </div>
  </section>

  <div class="grid" id="grid"></div>
</div>

<!-- MODAL: PRODUCT -->
<div class="overlay" id="ovProduct" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="mhead">
      <img id="mImg" alt="" />
      <div class="tt">
        <b id="mTitle">Produk</b>
        <span id="mSub">Pilih paket</span>
      </div>
      <button class="btn x" onclick="closeAll()">‚úï</button>
    </div>
    <div class="mbody">
      <div class="variants" id="variantList"></div>

      <div style="margin-top:12px" class="row">
        <span class="tag" id="selTag">Pilih paket dulu</span>
      </div>

      <div style="margin-top:12px" class="split">
        <button class="btn" onclick="closeAll()">Kembali</button>
        <button class="btn primary" id="btnCheckout" disabled>Checkout</button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL: LOGIN -->
<div class="overlay" id="ovLogin" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="mhead">
      <div class="tt">
        <b>Masuk dulu</b>
        <span>Wajib isi data sebelum checkout</span>
      </div>
      <button class="btn x" onclick="closeAll()">‚úï</button>
    </div>
    <div class="mbody">
      <input class="field" id="inpName" placeholder="Nama kamu (wajib)" />
      <div style="height:10px"></div>
      <input class="field" id="inpWA" placeholder="Nomor WhatsApp (contoh: 628xxxx)" inputmode="numeric" />
      <div class="mini">Tips: pakai format WA <b>62</b> tanpa <b>+</b>.</div>

      <div style="margin-top:12px" class="split">
        <button class="btn" onclick="closeAll()">Nanti dulu</button>
        <button class="btn primary" id="btnDoLogin">Simpan & Lanjut</button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL: PAY -->
<div class="overlay" id="ovPay" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="mhead">
      <div class="tt">
        <b>Checkout</b>
        <span id="paySub">Pilih pembayaran</span>
      </div>
      <button class="btn x" onclick="closeAll()">‚úï</button>
    </div>
    <div class="mbody">
      <div class="paydetails">
        <div class="row" style="justify-content:space-between">
          <div>
            <b id="sumProd">Produk</b>
            <div style="color:var(--m);font-size:12px" id="sumVar">Paket</div>
          </div>
          <div style="text-align:right">
            <div style="color:var(--m);font-size:12px">Harga</div>
            <b id="sumPrice">Rp 0</b>
          </div>
        </div>
      </div>

      <div class="paypick" id="payPick"></div>

      <div class="paydetails" id="payInfo"></div>

      <div style="margin-top:10px">
        <textarea class="field" id="note" rows="2" placeholder="Catatan (optional)"></textarea>
      </div>

      <label class="mini" style="display:flex;gap:10px;align-items:center;margin-top:10px;cursor:pointer">
        <input type="checkbox" id="paidTick" />
        Saya sudah bayar ‚úÖ (nanti kirim bukti ke admin)
      </label>

      <div style="margin-top:12px" class="split">
        <button class="btn" onclick="closeAll()">Kembali</button>
        <button class="btn primary" id="btnOrder">Order ke WhatsApp Admin</button>
      </div>

      <div class="mini">
        Setelah klik order, WhatsApp akan terbuka otomatis. Kalau tidak kebuka, cek pop-up/browser.
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast">Tersalin ‚úÖ</div>

<script>
// ===================== SETTING =====================
  const ADMIN_WA = "6285150895395"; // ganti nomor admin kamu (format 62xxxx)

  // Pembayaran (logo kecil saja + QRIS PNG baru)
  const PAY = {
    dana: { name:"Dana",  info:"087753513090 ‚Ä¢ a/n Kamxxx",  img:"https://images.bukaolshop.com/hosting/181218/f2f4904ff62a785161.png" },
    sea:  { name:"SeaBank", info:"901517870612 ‚Ä¢ a/n Kamxxx", img:"https://images.bukaolshop.com/hosting/181218/0d46bd2ba133491753.png" },
    qris: { name:"QRIS", info:"Scan QRIS (gambar)", img:"https://images.bukaolshop.com/hosting/181218/cce817858ef1663896.png" }
  };

  // ===================== DATA PRODUK (Lengkap sesuai list kamu) =====================
  const products = [
    { id:"alight", name:"Alight Motion Premium", img:"https://images.bukaolshop.com/hosting/181218/4a04b8d7e542788237.png",
      variants:[ {label:"Private Akun 1 Tahun", price:9600} ] },

    { id:"prime", name:"Prime Video", img:"https://images.bukaolshop.com/hosting/181218/ad8345f7b9c8953792.png",
      variants:[
        {label:"Shared 1 Bulan", price:6700},
        {label:"Private 1 Bulan", price:15300},
      ] },

    { id:"bstation", name:"Bstation Premium", img:"https://images.bukaolshop.com/hosting/181218/8a64287f1e0d26389.png",
      variants:[
        {label:"Akun Shared 3 Bulan", price:13300},
        {label:"Akun Private 1 Bulan", price:25300},
        {label:"Akun Private 2 Bulan", price:40300},
      ] },

    { id:"canva", name:"Canva Pro Premium", img:"https://images.bukaolshop.com/hosting/181218/fc56c689cb9f975773.png",
      variants:[
        {label:"Canva Anggota 2 Bulan", price:5600},
        {label:"Canva Pro Desainer 1 Bulan", price:5500},
        {label:"Canva Education 1 Tahun", price:16500},
      ] },

    { id:"capcut", name:"Capcut Pro Premium", img:"https://images.bukaolshop.com/hosting/181218/47f862f5ed4a892435.png",
      variants:[
        {label:"Private Akun 1 Bulan Gar 7h", price:11300},
        {label:"Private Akun 1 Bulan Gar 28h", price:20300},
      ] },

    { id:"chatgpt", name:"ChatGpt Premium", img:"https://images.bukaolshop.com/hosting/181218/26f804d66e6e88158.png",
      variants:[
        {label:"Member Plan 1 Bulan Private", price:25700},
        {label:"Owner Business Plan 1 Bulan", price:84300},
        {label:"Plus Plan 1 Bulan Private", price:20300},
        {label:"Plus Plan 1 Bulan Private (opsi 2)", price:30500},
      ] },

    { id:"iqiyi", name:"IQIYI Premium", img:"https://images.bukaolshop.com/hosting/181218/891f9cc79330873789.png",
      variants:[
        {label:"Iqiyi Premium 1 Bulan Shared", price:15300},
        {label:"Iqiyi Premium 1 Bulan Shared 2 Devices", price:23500},
      ] },

    { id:"vidio", name:"Vidio Premium", img:"https://images.bukaolshop.com/hosting/181218/1174d76c8ed6103972.png",
      variants:[
        {label:"Shared 1 Bulan 2 User Mobile", price:18800},
        {label:"Private 1 Bulan Khusus Mobile", price:32400},
      ] },

    { id:"vision", name:"Vision+ Premium", img:"https://images.bukaolshop.com/hosting/181218/072f4a242c47628279.png",
      variants:[
        {label:"Private Akun 1 Bulan All Screen", price:30000},
      ] },

    { id:"viu", name:"Viu Premium", img:"https://images.bukaolshop.com/hosting/181218/e185c3b3935534665.png",
      variants:[
        {label:"Private 3 Bulan 1 Device", price:7000},
        {label:"Private 6 Bulan 1 Device", price:8600},
      ] },

    { id:"wetv", name:"Wetv Premium", img:"https://images.bukaolshop.com/hosting/181218/9639c4484b80226918.png",
      variants:[
        {label:"Wetv Premium 1 Bulan Shared", price:13600},
        {label:"Wetv Premium 1 Bulan Private", price:35300},
      ] },

    { id:"youtube", name:"YouTube Premium", img:"https://images.bukaolshop.com/hosting/181218/e1b9eae8982d985428.png",
      variants:[
        {label:"Anggota Family Plan 1 Bulan Invited", price:8300},
      ] },

    { id:"netflix", name:"Netflix Premium", img:"https://images.bukaolshop.com/hosting/181218/e97361a0f1be36831.png",
      variants:[
        {label:"Sharing 1 Bulan 1p1u", price:32000},
        {label:"Sharing 1 Bulan 1p2u", price:26300},
        {label:"Private 1 Bulan", price:200000},
      ] },

    { id:"remini", name:"Remini Premium", img:"https://images.bukaolshop.com/hosting/181218/e0211889cbb1648699.png",
      variants:[
        {label:"Sharing 1 Bulan", price:16400},
        {label:"Private 1 Bulan", price:25300},
        {label:"Private 1 Tahun", price:35300},
      ] },

    { id:"disney", name:"Disney Premium", img:"https://images.bukaolshop.com/hosting/181218/db9934847fa6433172.png",
      variants:[
        {label:"Shared 1 User 1 Bulan", price:25300},
        {label:"Shared 6 User 1 Bulan", price:32300},
      ] },

    { id:"spotify", name:"Spotify Premium", img:"https://images.bukaolshop.com/hosting/181218/ff232ca6b143229137.png",
      variants:[
        {label:"Famplan 1 Bulan", price:19300},
        {label:"Indplan 1 Bulan", price:26300},
        {label:"Famplan 2 Bulan", price:30300},
      ] },
  ];

  // ===================== HELPERS =====================
  const $ = (id)=>document.getElementById(id);
  const rupiah = (n)=>"Rp " + (n||0).toLocaleString("id-ID");
  function toast(msg="OK ‚úÖ"){
    const t=$("toast");
    t.textContent=msg;
    t.classList.add("show");
    setTimeout(()=>t.classList.remove("show"), 1200);
  }

  // ===================== RENDER GRID =====================
  let filtered = [...products];
  function render(){
    const g = $("grid");
    g.innerHTML = filtered.map(p=>{
      const min = Math.min(...p.variants.map(v=>v.price));
      const max = Math.max(...p.variants.map(v=>v.price));
      const range = (min===max) ? rupiah(min) : `${rupiah(min)} - ${rupiah(max)}`;
      return `
        <div class="card" onclick="openProduct('${p.id}')">
          <div class="thumb"><img src="${p.img}" alt=""></div>
          <div class="cbody">
            <b>${p.name}</b>
            <span>${p.variants.length} paket ‚Ä¢ ${range}</span>
            <span class="tag">Pesan</span>
          </div>
        </div>
      `;
    }).join("");
  }

  // ===================== STATE =====================
  let selProd = null;
  let selVarIndex = -1;
  let payMethod = "qris"; // default

  function openProduct(id){
    selProd = products.find(p=>p.id===id);
    selVarIndex = -1;
    $("mImg").src = selProd.img;
    $("mTitle").textContent = selProd.name;
    $("mSub").textContent = "Pilih paket untuk lihat harga";
    $("selTag").textContent = "Pilih paket dulu";
    $("btnCheckout").disabled = true;

    const list = $("variantList");
    list.innerHTML = selProd.variants.map((v,i)=>`
      <div class="vbtn" id="v_${i}" onclick="pickVar(${i})">
        <div>
          <b>${v.label}</b>
          <small>${selProd.name}</small>
        </div>
        <div><b>${rupiah(v.price)}</b></div>
      </div>
    `).join("");

    show("ovProduct");
  }

  function pickVar(i){
    selVarIndex = i;
    [...document.querySelectorAll(".vbtn")].forEach(el=>el.classList.remove("active"));
    const el = $("v_"+i);
    if(el) el.classList.add("active");

    const v = selProd.variants[i];
    $("selTag").textContent = `Dipilih: ${v.label} ‚Ä¢ ${rupiah(v.price)}`;
    $("btnCheckout").disabled = false;
    $("btnCheckout").onclick = ()=> goCheckout();
  }

  // ===================== LOGIN + CHECKOUT FLOW =====================
  function isLogged(){
    return !!localStorage.getItem("kp_name") && !!localStorage.getItem("kp_wa");
  }
  function setLoggedUI(){
    const nm = localStorage.getItem("kp_name");
    $("btnLoginTop").textContent = nm ? nm : "Masuk";
    $("btnLoginTop").onclick = ()=> {
      if(nm){ logout(); } else { show("ovLogin"); }
    };
  }
  function logout(){
    localStorage.removeItem("kp_name");
    localStorage.removeItem("kp_wa");
    toast("Logout ‚úÖ");
    setLoggedUI();
  }

  function goCheckout(){
    closeAll();
    if(!isLogged()){
      show("ovLogin");
      // setelah login lanjut ke checkout
      $("btnDoLogin").dataset.next = "pay";
    }else{
      openPay();
    }
  }

  $("btnDoLogin").onclick = ()=>{
    const name = $("inpName").value.trim();
    const wa = $("inpWA").value.trim().replace(/\s+/g,"");
    if(!name || !wa){ toast("Isi Nama & WA dulu"); return; }
    if(!/^62\d{7,16}$/.test(wa)){ toast("Format WA harus 62xxxx"); return; }
    localStorage.setItem("kp_name", name);
    localStorage.setItem("kp_wa", wa);
    setLoggedUI();
    closeAll();
    if($("btnDoLogin").dataset.next==="pay") openPay();
  };

  function openPay(){
    if(!selProd || selVarIndex<0){ toast("Pilih paket dulu"); return; }
    const v = selProd.variants[selVarIndex];
    $("sumProd").textContent = selProd.name;
    $("sumVar").textContent = v.label;
    $("sumPrice").textContent = rupiah(v.price);
    $("note").value = "";
    $("paidTick").checked = false;

    // render payment pick
    const pick = $("payPick");
    const keys = ["dana","sea","qris"];
    pick.innerHTML = keys.map(k=>{
      const p = PAY[k];
      return `
        <div class="pay ${k===payMethod?"active":""}" onclick="setPay('${k}')">
          <img src="${p.img}" alt="">
          <div>
            <b>${p.name}</b>
            <span>${p.info}</span>
          </div>
        </div>
      `;
    }).join("");

    setPay(payMethod, true);
    $("btnOrder").onclick = ()=> orderToAdmin();
    show("ovPay");
  }

  function setPay(k, silent=false){
    payMethod = k;
    [...document.querySelectorAll(".pay")].forEach(el=>el.classList.remove("active"));
    const all = $("payPick").children;
    for(const el of all){
      if(el && el.getAttribute("onclick")?.includes(`'${k}'`)) el.classList.add("active");
    }

    const info = $("payInfo");
    if(k==="dana"){
      info.innerHTML = `
        <b>Pembayaran via Dana</b>
        <div class="mini"><b>${PAY.dana.info}</b><br>Transfer sesuai nominal, lalu kirim bukti ke admin.</div>
      `;
    }else if(k==="sea"){
      info.innerHTML = `
        <b>Pembayaran via SeaBank</b>
        <div class="mini"><b>${PAY.sea.info}</b><br>Transfer sesuai nominal, lalu kirim bukti ke admin.</div>
      `;
    }else{
      info.innerHTML = `
        <b>Pembayaran via QRIS</b>
        <div class="mini">Scan QRIS di bawah ini, bayar sesuai nominal, lalu kirim bukti ke admin.</div>
        <div class="qrisimg"><img src="${PAY.qris.img}" alt="QRIS"></div>
      `;
    }
    if(!silent) toast("Metode dipilih ‚úÖ");
  }

  function orderToAdmin(){
    const name = localStorage.getItem("kp_name") || "";
    const wa = localStorage.getItem("kp_wa") || "";
    if(!name || !wa){ toast("Masuk dulu"); closeAll(); show("ovLogin"); $("btnDoLogin").dataset.next="pay"; return; }
    if(!selProd || selVarIndex<0){ toast("Pilih paket dulu"); return; }

    const v = selProd.variants[selVarIndex];
    const methodLabel = (payMethod==="dana") ? "Dana" : (payMethod==="sea" ? "SeaBank" : "QRIS");
    const paid = $("paidTick").checked ? "Sudah Bayar ‚úÖ (bukti menyusul)" : "Belum Bayar";
    const note = $("note").value.trim();

    const text =
`Halo Admin KivoPay, saya mau order:

Nama: ${name}
WhatsApp: ${wa}

Produk: ${selProd.name}
Paket: ${v.label}
Harga: ${rupiah(v.price)}

Metode Bayar: ${methodLabel}
Status: ${paid}
${note ? `Catatan: ${note}\n` : ""}
Mohon diproses ya kak üôè`;

    const url = `https://wa.me/${ADMIN_WA}?text=${encodeURIComponent(text)}`;
    window.open(url, "_blank");
  }

  // ===================== MODAL CONTROL =====================
  function show(id){ $(id).classList.add("show"); }
  function hide(id){ $(id).classList.remove("show"); }
  function closeAll(){ ["ovProduct","ovLogin","ovPay"].forEach(hide); }

  // close on overlay click
  ["ovProduct","ovLogin","ovPay"].forEach(id=>{
    $(id).addEventListener("click",(e)=>{ if(e.target.id===id) closeAll(); });
  });

  // ===================== SEARCH =====================
  $("q").addEventListener("input", ()=>{
    const s = $("q").value.trim().toLowerCase();
    filtered = products.filter(p=> p.name.toLowerCase().includes(s));
    render();
  });
  $("btnReset").onclick = ()=>{
    $("q").value="";
    filtered=[...products];
    render();
  };

  // ===================== TOP LOGIN BUTTON =====================
  $("btnLoginTop").onclick = ()=> show("ovLogin");

  // ===================== TYPING ANIMATION (Hero) =====================
  const typingMsg = "Selamat berbelanja di KivoPay ‚ò∫Ô∏è ‚Ä¢ Klik produk untuk lihat paket & harga ‚Ä¢ Checkout via WhatsApp Admin";
  let tIndex=0, tForward=true;
  function typeLoop(){
    const el = $("typingText");
    if(!el) return;
    if(tForward){
      tIndex++;
      if(tIndex>=typingMsg.length){ tForward=false; setTimeout(typeLoop, 1000); return; }
    }else{
      tIndex--;
      if(tIndex<=0){ tForward=true; setTimeout(typeLoop, 300); return; }
    }
    el.textContent = typingMsg.slice(0,tIndex);
    setTimeout(typeLoop, 40);
  }

  // ===================== INIT =====================
  setLoggedUI();
  render();
  typeLoop();
</script>
</body>
</html>
```Ó®Å0Ó®Ç
